Spark Executor Command: "/opt/jdk1.8.0_131/jre/bin/java" "-cp" "/var/tmp/spark2.0hpcplatform/lib/firesteel-2.4.0.jar:/var/tmp/spark2.0hpcplatform/multicore/worker3/conf/:/var/tmp/spark2.0hpcplatform/multicore/worker3/assembly/target/scala-2.11/jars/*:/opt/hadoop/etc/hadoop/" "-Xmx24576M" "-Dspark.driver.port=39133" "-Dspark.rpc.netty.dispatcher.numThreads=10" "-XX:ParallelGCThreads=10" "org.apache.spark.executor.CoarseGrainedExecutorBackend" "--driver-url" "spark://CoarseGrainedScheduler@mdc-ch1-cust4.mdc.ext.hpe.com:39133" "--executor-id" "19" "--hostname" "mdc-ch1-cust4" "--cores" "144" "--app-id" "app-20190621021028-0003" "--worker-url" "spark://Worker@mdc-ch1-cust4:39957"
========================================

19/06/21 02:10:45 INFO executor.CoarseGrainedExecutorBackend: Started daemon with process name: 113754@mdc-ch1-cust4
19/06/21 02:10:45 INFO util.SignalUtils: Registered signal handler for TERM
19/06/21 02:10:45 INFO util.SignalUtils: Registered signal handler for HUP
19/06/21 02:10:45 INFO util.SignalUtils: Registered signal handler for INT
19/06/21 02:10:45 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
19/06/21 02:10:45 INFO spark.SecurityManager: Changing view acls to: root
19/06/21 02:10:45 INFO spark.SecurityManager: Changing modify acls to: root
19/06/21 02:10:45 INFO spark.SecurityManager: Changing view acls groups to: 
19/06/21 02:10:45 INFO spark.SecurityManager: Changing modify acls groups to: 
19/06/21 02:10:45 INFO spark.SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(root); groups with view permissions: Set(); users  with modify permissions: Set(root); groups with modify permissions: Set()
19/06/21 02:10:46 INFO client.TransportClientFactory: Successfully created connection to mdc-ch1-cust4.mdc.ext.hpe.com/10.1.1.4:39133 after 44 ms (0 ms spent in bootstraps)
19/06/21 02:10:46 WARN spark.SparkConf: The configuration key 'spark.kryoserializer.buffer.max.mb' has been deprecated as of Spark 1.4 and may be removed in the future. Please use the new key 'spark.kryoserializer.buffer.max' instead.
19/06/21 02:10:46 INFO spark.SecurityManager: Changing view acls to: root
19/06/21 02:10:46 INFO spark.SecurityManager: Changing modify acls to: root
19/06/21 02:10:46 INFO spark.SecurityManager: Changing view acls groups to: 
19/06/21 02:10:46 INFO spark.SecurityManager: Changing modify acls groups to: 
19/06/21 02:10:46 INFO spark.SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(root); groups with view permissions: Set(); users  with modify permissions: Set(root); groups with modify permissions: Set()
19/06/21 02:10:46 INFO client.TransportClientFactory: Successfully created connection to mdc-ch1-cust4.mdc.ext.hpe.com/10.1.1.4:39133 after 1 ms (0 ms spent in bootstraps)
19/06/21 02:10:46 INFO storage.DiskBlockManager: Created local directory at /data/spark-e463ffc0-1f3e-497e-8062-3d2a50ca29e2/executor-7b5afad6-fb7c-4820-b5fb-3ffbd03f3cf6/blockmgr-115c8b2b-111d-4ed0-8f5c-623e268afeaa
19/06/21 02:10:46 INFO memory.MemoryStore: MemoryStore started with capacity 12.6 GB
19/06/21 02:10:46 INFO executor.CoarseGrainedExecutorBackend: Connecting to driver: spark://CoarseGrainedScheduler@mdc-ch1-cust4.mdc.ext.hpe.com:39133
19/06/21 02:10:46 INFO worker.WorkerWatcher: Connecting to worker spark://Worker@mdc-ch1-cust4:39957
19/06/21 02:10:46 INFO client.TransportClientFactory: Successfully created connection to mdc-ch1-cust4/10.1.1.4:39957 after 0 ms (0 ms spent in bootstraps)
19/06/21 02:10:46 INFO worker.WorkerWatcher: Successfully connected to spark://Worker@mdc-ch1-cust4:39957
19/06/21 02:10:46 INFO executor.CoarseGrainedExecutorBackend: Successfully registered with driver
19/06/21 02:10:46 INFO executor.Executor: Starting executor ID 19 on host mdc-ch1-cust4
19/06/21 02:10:46 INFO util.Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 42251.
19/06/21 02:10:46 INFO netty.NettyBlockTransferService: Server created on mdc-ch1-cust4:42251
19/06/21 02:10:46 INFO storage.BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
19/06/21 02:10:46 INFO storage.BlockManagerMaster: Registering BlockManager BlockManagerId(19, mdc-ch1-cust4, 42251, None)
19/06/21 02:10:46 INFO storage.BlockManagerMaster: Registered BlockManager BlockManagerId(19, mdc-ch1-cust4, 42251, None)
19/06/21 02:10:46 INFO storage.BlockManager: Initialized BlockManager: BlockManagerId(19, mdc-ch1-cust4, 42251, None)
19/06/21 02:10:48 INFO executor.CoarseGrainedExecutorBackend: Got assigned task 651
19/06/21 02:10:48 INFO executor.CoarseGrainedExecutorBackend: Got assigned task 656
19/06/21 02:10:48 INFO executor.CoarseGrainedExecutorBackend: Got assigned task 661
19/06/21 02:10:48 INFO executor.Executor: Running task 166.1 in stage 2.0 (TID 661)
19/06/21 02:10:48 INFO executor.Executor: Running task 76.1 in stage 2.0 (TID 656)
19/06/21 02:10:48 INFO executor.Executor: Running task 130.1 in stage 2.0 (TID 651)
19/06/21 02:10:48 INFO executor.Executor: Fetching spark://mdc-ch1-cust4.mdc.ext.hpe.com:39133/jars/simple-reduceby-computation-project_2.11-1.0.jar with timestamp 1561108228070
19/06/21 02:10:48 INFO client.TransportClientFactory: Successfully created connection to mdc-ch1-cust4.mdc.ext.hpe.com/10.1.1.4:39133 after 1 ms (0 ms spent in bootstraps)
19/06/21 02:10:48 INFO util.Utils: Fetching spark://mdc-ch1-cust4.mdc.ext.hpe.com:39133/jars/simple-reduceby-computation-project_2.11-1.0.jar to /data/spark-e463ffc0-1f3e-497e-8062-3d2a50ca29e2/executor-7b5afad6-fb7c-4820-b5fb-3ffbd03f3cf6/spark-b6ef19c4-6c5a-46c6-8bd0-cae485ed9439/fetchFileTemp355696475956680826.tmp
19/06/21 02:10:48 INFO util.Utils: Copying /data/spark-e463ffc0-1f3e-497e-8062-3d2a50ca29e2/executor-7b5afad6-fb7c-4820-b5fb-3ffbd03f3cf6/spark-b6ef19c4-6c5a-46c6-8bd0-cae485ed9439/19627663661561108228070_cache to /var/tmp/spark2.0hpcplatform/multicore/worker3/work/app-20190621021028-0003/19/./simple-reduceby-computation-project_2.11-1.0.jar
19/06/21 02:10:48 INFO executor.Executor: Adding file:/var/tmp/spark2.0hpcplatform/multicore/worker3/work/app-20190621021028-0003/19/./simple-reduceby-computation-project_2.11-1.0.jar to class loader
19/06/21 02:10:49 INFO broadcast.TorrentBroadcast: Started reading broadcast variable 2
19/06/21 02:10:49 INFO client.TransportClientFactory: Successfully created connection to mdc-ch1-cust4/10.1.1.4:39353 after 1 ms (0 ms spent in bootstraps)
19/06/21 02:10:49 INFO memory.MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 2.2 KB, free 12.6 GB)
19/06/21 02:10:49 INFO broadcast.TorrentBroadcast: Reading broadcast variable 2 took 235 ms
19/06/21 02:10:49 INFO memory.MemoryStore: Block broadcast_2 stored as values in memory (estimated size 3.7 KB, free 12.6 GB)
19/06/21 02:10:49 INFO shm.ShmShuffleManager: ShmShuffleManager obtains SPARK_WORKER_CORES: 64
19/06/21 02:10:49 INFO shm.ShmShuffleManager: to initialize shm shuffle manager in an executor, with executor id string value:19
19/06/21 02:10:49 INFO shuffle.ShuffleStoreManager: jnishmshuffle shared library loaded via loadLibraryFromJar
19/06/21 02:10:49 INFO shuffle.ShuffleStoreManager: perform actual initialization for ShuffleStoreManager
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0621 02:10:49.353539 113848 MapShuffleStoreManager.cc:101] map shuffle store manage initialize
I0621 02:10:49.353586 113848 ByteBufferPool.cc:44] initialize queue-based bytebuffer pool
I0621 02:10:49.353595 113848 ArrayBufferPool.cc:44] initialize queue-based array-buffer pool
I0621 02:10:49.353598 113848 ArrayBufferPool.cc:44] initialize queue-based array-buffer pool
I0621 02:10:49.353600 113848 ArrayBufferPool.cc:44] initialize queue-based array-buffer pool
I0621 02:10:49.353602 113848 ArrayBufferPool.cc:44] initialize queue-based array-buffer pool
I0621 02:10:49.353605 113848 ArrayBufferPool.cc:44] initialize queue-based array-buffer pool
I0621 02:10:49.353606 113848 ArrayBufferPool.cc:44] initialize queue-based array-buffer pool
I0621 02:10:49.353608 113848 ArrayBufferPool.cc:44] initialize queue-based array-buffer pool
I0621 02:10:49.353610 113848 ArrayBufferPool.cc:44] initialize queue-based array-buffer pool
I0621 02:10:49.353636 113848 SharedMemoryAllocator.h:64] rmb default log level chosen is: info
I0621 02:10:49.355027 113848 SharedMemoryAllocator.h:201] rmb shared memory manager detected a single-partitioned shm path: /lfs/spark_global0
0000001 | T.0x00007f3e2e95c700 | 2019-06-21, 02:10:49.355079 [info] - (/home/ghosdebd/sparkle/alps/src/globalheap/globalheap_internal.cc, 153) Open heap path: /lfs/spark_global0 
0000002 | T.0x00007f3e2e95c700 | 2019-06-21, 02:10:49.355859 [info] - (/home/ghosdebd/sparkle/alps/src/pegasus/lfs_region_file.cc, 64) Open LFS region file path: "/lfs/spark_global0" flags: O_RDWR
0000004 | T.0x00007f3e2e95c700 | 2019-06-21, 02:10:49.361012 [info] - (/home/ghosdebd/sparkle/alps/src/pegasus/segmap.cc, 39) map region  base_addr: 0x7ebd07584000 size: 549755813888 addr_range: 0x7ebd07584000--7f3d07584000
0000005 | T.0x00007f3e2e95c700 | 2019-06-21, 02:10:49.361047 [info] - (/home/ghosdebd/sparkle/alps/src/globalheap/globalheap_internal.cc, 158) Opened heap path: /lfs/spark_global0  size: 549755813888
I0621 02:10:49.361213 113848 SharedMemoryAllocator.h:93] rmb shared memory manager initialized global heap:0x2ca8140
I0621 02:10:49.361302 113848 SharedMemoryManager.cc:64] shared-memory manager registered heap: /lfs/spark_global0
I0621 02:10:49.361306 113848 ShuffleDataSharedMemoryManager.h:162] shuffle engine has opened heap: /lfs/spark_global0
I0621 02:10:49.361315 113848 ShuffleStoreManager.cc:140] shuffle store manager initialized with executor id 19 and generation id: 72
19/06/21 02:10:49 INFO shm.ShmShuffleWriter:  Map Thread: 73 created the serialization buffer with size: 1073741824: SUCCESS
19/06/21 02:10:49 INFO shm.ShmShuffleWriter:  Map Thread: 71 created the serialization buffer with size: 1073741824: SUCCESS
19/06/21 02:10:49 INFO shm.ShmShuffleWriter:  Map Thread: 72 created the serialization buffer with size: 1073741824: SUCCESS
19/06/21 02:10:50 INFO memory.MemoryStore: Block rdd_3_130 stored as values in memory (estimated size 83.9 MB, free 12.5 GB)
19/06/21 02:10:50 INFO memory.MemoryStore: Block rdd_3_166 stored as values in memory (estimated size 83.9 MB, free 12.5 GB)
19/06/21 02:10:50 INFO memory.MemoryStore: Block rdd_3_76 stored as values in memory (estimated size 83.9 MB, free 12.4 GB)
19/06/21 02:10:50 INFO shuffle.MapSHMShuffleStore: store id1 map-side shared-memory based shuffle store started with ordering: false
19/06/21 02:10:50 INFO shuffle.MapSHMShuffleStore: store id0 map-side shared-memory based shuffle store started with ordering: false
I0621 02:10:50.336143 113848 shuffle_MapSHMShuffleStore.cc:46] ***get map shuffle store manager with address: 0x0x2ca8030
I0621 02:10:50.336163 113847 shuffle_MapSHMShuffleStore.cc:46] ***get map shuffle store manager with address: 0x0x2ca8030
19/06/21 02:10:50 INFO shuffle.MapSHMShuffleStore: store id2 map-side shared-memory based shuffle store started with ordering: false
I0621 02:10:50.336666 113848 MapShuffleStoreManager.cc:43] create long-key map shuffle store with shuffle id:0 map id: 76 and ordering: 0
I0621 02:10:50.336678 113848 shuffle_MapSHMShuffleStore.cc:106] ***return from ninitialization.
I0621 02:10:50.336689 113850 shuffle_MapSHMShuffleStore.cc:46] ***get map shuffle store manager with address: 0x0x2ca8030
I0621 02:10:50.337062 113847 MapShuffleStoreManager.cc:43] create long-key map shuffle store with shuffle id:0 map id: 130 and ordering: 0
I0621 02:10:50.337070 113847 shuffle_MapSHMShuffleStore.cc:106] ***return from ninitialization.
I0621 02:10:50.337111 113850 MapShuffleStoreManager.cc:43] create long-key map shuffle store with shuffle id:0 map id: 166 and ordering: 0
I0621 02:10:50.337118 113850 shuffle_MapSHMShuffleStore.cc:106] ***return from ninitialization.
I0621 02:10:50.495196 113850 MapShuffleStoreWithLongKeys.cc:134] keys 0x7ebc44728010 with size tracker: 500000 reaches buffer size: 500000
I0621 02:10:50.496908 113847 MapShuffleStoreWithLongKeys.cc:134] keys 0x7ebc4620d010 with size tracker: 500000 reaches buffer size: 500000
I0621 02:10:50.500824 113848 MapShuffleStoreWithLongKeys.cc:134] keys 0x7ebc4569b010 with size tracker: 500000 reaches buffer size: 500000
I0621 02:10:50.534396 113850 MapShuffleStoreWithLongKeys.cc:134] keys 0x7ebc42842010 with size tracker: 1000000 reaches buffer size: 500000
I0621 02:10:50.539692 113847 MapShuffleStoreWithLongKeys.cc:134] keys 0x7ebc4115e010 with size tracker: 1000000 reaches buffer size: 500000
I0621 02:10:50.542984 113848 MapShuffleStoreWithLongKeys.cc:134] keys 0x7ebc3fa7a010 with size tracker: 1000000 reaches buffer size: 500000
I0621 02:10:50.571992 113850 MapShuffleStoreWithLongKeys.cc:134] keys 0x7ebc3d824010 with size tracker: 1500000 reaches buffer size: 500000
I0621 02:10:50.581892 113847 MapShuffleStoreWithLongKeys.cc:134] keys 0x7ebc4115e010 with size tracker: 1500000 reaches buffer size: 500000
I0621 02:10:50.585119 113848 MapShuffleStoreWithLongKeys.cc:134] keys 0x7ebc3b5ce010 with size tracker: 1500000 reaches buffer size: 500000
0000006 | T.0x00007f3e2ea5d700 | 2019-06-21, 02:10:50.615835 [info] - (/home/ghosdebd/sparkle/alps/src/globalheap/globalheap_internal.cc, 380) Allocate block size: 4012
0000007 | T.0x00007f3e2ea5d700 | 2019-06-21, 02:10:50.615903 [info] - (/home/ghosdebd/sparkle/alps/src/globalheap/globalheap_internal.cc, 400) Allocate block size: 4012 ig: 0
0000008 | T.0x00007f3e2ea5d700 | 2019-06-21, 02:10:50.616144 [info] - (/home/ghosdebd/sparkle/alps/src/globalheap/memattrib_heap.cc, 59) Allocate block size: 4012
0000009 | T.0x00007f3e2ea5d700 | 2019-06-21, 02:10:50.616157 [info] - (/home/ghosdebd/sparkle/alps/src/globalheap/process_slab_heap.cc, 30) acquire_slab
0000010 | T.0x00007f3e2ea5d700 | 2019-06-21, 02:10:50.616163 [info] - (/home/ghosdebd/sparkle/alps/src/globalheap/process_slab_heap.cc, 33) acquire_slab: locked
0000011 | T.0x00007f3e2ea5d700 | 2019-06-21, 02:10:50.616168 [info] - (/home/ghosdebd/sparkle/alps/src/globalheap/extentheap.hh, 116) malloc
0000012 | T.0x00007f3e2ea5d700 | 2019-06-21, 02:10:50.616525 [info] - (/home/ghosdebd/sparkle/alps/src/globalheap/extentheap.hh, 116) malloc
0000013 | T.0x00007f3e2ea5d700 | 2019-06-21, 02:10:50.616545 [info] - (/home/ghosdebd/sparkle/alps/src/globalheap/extentheap.hh, 116) malloc
0000014 | T.0x00007f3e2ea5d700 | 2019-06-21, 02:10:50.616550 [info] - (/home/ghosdebd/sparkle/alps/src/globalheap/extentheap.hh, 130) acquire_new_zone
0000015 | T.0x00007f3e2ea5d700 | 2019-06-21, 02:10:50.616566 [info] - (/home/ghosdebd/sparkle/alps/src/globalheap/extentheap.hh, 137) acquire_new_zone: zone_id: null
0000016 | T.0x00007f3e2ea5d700 | 2019-06-21, 02:10:50.616571 [info] - (/home/ghosdebd/sparkle/alps/src/globalheap/process_slab_heap.cc, 64) acquire_slab: unlock 3: slab=0
0000017 | T.0x00007f3e2ea5d700 | 2019-06-21, 02:10:50.616579 [warning] - (/home/ghosdebd/sparkle/alps/src/globalheap/thread_slab_heap.cc, 47) Out of memory
E0621 02:10:50.616588 113850 MapShuffleStoreWithLongKeys.cc:216] allocate index chunk returns global null pointer  for size: 4012 generation id: 72
F0621 02:10:50.616600 113850 MapShuffleStoreWithLongKeys.cc:229] Check failed: indChunkOffset != nullptr allocate index chunk returns null with generation id: 72
*** Check failure stack trace: ***
